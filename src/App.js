//import logo from './logo.svg';
import './App.css';
//import home from './containers/home/Index';
import React,{useState,useEffect} from 'react';
import Message from './Message';
import {Button,FormControl,InputLabel,Input,IconButton} from "@material-ui/core";
import db from './firebase';
import firebase from 'firebase';
import FlipMove from 'react-flip-move';
import SendIcon from '@material-ui/icons/Send';

function App() {
  const [input,setInput] = useState('');
  const [messages,setMessages] = useState([]);
  const [username,setusername] = useState('');

  useEffect(()=>{
    db.collection('messages')
    .orderBy('timestamp','desc')
    .onSnapshot(snapshot=>{
    setMessages(snapshot.docs.map(doc => ({id:doc.id, message:doc.data()})))
    });

  },[]);

  useEffect(()=> {
   // const name= prompt('please enter your name')
    setusername (prompt ('enter your name'));
  },[])

    const sendMessage = (event) => {
      event.preventDefault();
      db.collection("messages").add({
        message:input,
        username:username,
        timestamp:firebase.firestore.FieldValue.serverTimestamp(),
      });
     // console.log(firebase.firestoreApp.fieldValue.serverTimestamp());
     // setMessages([...messages,{username:username , message:input}])
      setInput('');
    }
  
  
  return (
    <div className="App">
      <img src="data:image/jpeg;base64,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"/>
   <h1> Welcome {username}</h1>
   <div className="form">
   <form className="app_form">
   <FormControl className="app_control">
   
   <Input className="app_input" placeholder="Enter a message" value={input} onChange={event=>setInput(event.target.value)}/>
   <IconButton className="app_button" disabled={!input} variant="contained" color="primary" type='submit' onClick={sendMessage}>
     <SendIcon/>
   </IconButton>  

   </FormControl>
   </form> 
   </div>
   <FlipMove>
   {
     messages.map(({message,id})=>(
       <Message key={id} username={username} message={message}  />
     ))
   }
   </FlipMove>
    </div>
  );
}

export default App ;